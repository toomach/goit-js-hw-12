{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["\"use strict\";\n\nimport axios from 'axios';\n\nconst API_KEY = \"43236176-8efbdba212834d112cbf0fa21\";\nconst BASE_URL = 'https://pixabay.com/api/?';\nexport const PER_PAGE = 15;\n\nexport async function fetchImages(searchValue, page = 1) {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: searchValue,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: PER_PAGE,\n      }\n    });\n    \n    return response.data;\n  } catch (error) {\n    throw new Error(error.response.statusText);\n  }\n}\n\n  \n\n","\"use strict\";\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst lightbox = new SimpleLightbox('.gallery-list a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function getGallery(parent, arr) {\n  parent.innerHTML += getMarkup(arr);\n  lightbox.refresh();\n}\n\nfunction getMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n      ` <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <figure class=\"gallery-figure\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              width=\"360\"\n            />\n            <figcaption class=\"gallery-figcaption\">\n              <ul class=\"gallery-text\">\n                <li>\n                  <span>Likes</span>\n                  <p>${likes}</p>\n                </li>\n                <li>\n                  <span>Views</span>\n                  <p>${views}</p>\n                </li>\n                <li>\n                  <span>Comments</span>\n                  <p>${comments}</p>\n                </li>\n                <li>\n                  <span>Downloads</span>\n                  <p>${downloads}</p>\n                </li>\n              </ul>\n            </figcaption>\n          </figure>\n        </a>\n      </li>`\n    )\n    .join('');\n}\n","\"use strict\";\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { fetchImages } from './js/pixabay-api';\nimport { PER_PAGE } from './js/pixabay-api';\nimport { getGallery } from './js/render-functions.js';\n\nconst searchForm = document.querySelector('.js-search-form');\nconst input = document.querySelector('.search-input');\nconst galleryList = document.querySelector('.gallery-list');\nconst loader = document.querySelector('.loader-wrapper');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nlet currentPage = 1;\nlet currentSearchValue = '';\n\n\nsearchForm.addEventListener('submit', handleSearch);\n\nloadMoreBtn.addEventListener('click', loadMoreImages);\n\nasync function handleSearch(event) {\n    event.preventDefault();\n    galleryList.innerHTML = '';\n    currentPage = 1;\n    currentSearchValue = input.value.trim();\n\n    loadMoreBtn.classList.add('is-hidden');\n\n    if (currentSearchValue === '') {\n        errorMessage(`Please fill out the input field!`);\n        return;\n    }\n\n    loader.classList.remove('is-hidden');\n\n    try {\n        const data = await fetchImages(currentSearchValue, currentPage);\n        \n        if (data.hits.length === 0) {\n            errorMessage(`Sorry, there are no images matching your search query. Please try again!`);\n            return;\n        }\n\n        getGallery(galleryList, data.hits);\n        showLoadMoreBtn(data.totalHits);\n    } catch (error) {\n        console.error(error);\n    } finally {\n        loader.classList.add('is-hidden');\n        searchForm.reset();\n    }\n}\n\nasync function loadMoreImages() {\n    currentPage +=1;\n\n    loader.classList.remove('is-hidden');\n\n    try {\n        const data = await fetchImages(currentSearchValue, currentPage);\n\n        // Перевірка на випадок пустої відповіді від API\n        \n        if (data.hits.length === 0) {\n            loadMoreBtn.classList.add('is-hidden');\n            errorMessage(`We're sorry, but you've reached the end of search results.`);\n            return;\n        }\n\n        getGallery(galleryList, data.hits);\n        smoothScrollByGalleryHeight();\n\n        const totalPages = Math.ceil(data.totalHits / PER_PAGE);\n        if (currentPage >= totalPages) {\n            loadMoreBtn.classList.add('is-hidden');\n            iziToast.info({\n                ...iziToastParam,\n                message: `We're sorry, but you've reached the end of search results.`,\n            });\n        }\n    } catch (error) {\n        console.error(error);\n    } finally {\n        loader.classList.add('is-hidden');\n    }\n}\n\nfunction showLoadMoreBtn(totalHits) {\n    if (totalHits > PER_PAGE) {\n        loadMoreBtn.classList.remove('is-hidden');\n    }\n}\n\nfunction smoothScrollByGalleryHeight() {\n    const galleryHeight = document.querySelector('.gallery-item').getBoundingClientRect().height;\n    window.scrollBy({\n        top: galleryHeight * 2,\n        behavior: 'smooth',\n    })\n}\n\nconst iziToastParam = {\n    title: '',\n    position: 'topRight',\n    backgroundColor: '#ef4040',\n    messageColor: '#fff',\n    titleColor: '#fff',\n    timeout: 3000,\n    pauseOnHover: false,\n}\n\nfunction errorMessage(message) {\n    iziToast.error({\n        ...iziToastParam,\n        message: `${message}`,\n    })\n}\n\n"],"names":["API_KEY","BASE_URL","PER_PAGE","fetchImages","searchValue","page","axios","error","lightbox","SimpleLightbox","getGallery","parent","arr","getMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","input","galleryList","loader","loadMoreBtn","currentPage","currentSearchValue","handleSearch","loadMoreImages","event","errorMessage","data","showLoadMoreBtn","smoothScrollByGalleryHeight","totalPages","iziToast","iziToastParam","totalHits","galleryHeight","message"],"mappings":"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"}